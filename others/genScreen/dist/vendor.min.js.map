{"version":3,"sources":["vendor.js"],"names":["KHPGen","aniSpeed","minus_icon","[object Object]","selector","content","duration","$","fadeOut","html","fadeIn","takeThis","appendHere","css","display","appendTo","slideDown","elem","parent","after","clone","hide","next","a","slideUp","remove","aniAppendTo","b","find","aniReplaceHTML","attr","string","filename","UNIQUE_ID","blob","Blob","type","saveAs","saveAsJSON","generateCodeFromUserInput","RAW_DATA","finalMasPoster","val","each","index","value","processingEpElem","checkSubsExist","inputEpPoster","title","sources","finalEpPoster","preThumbSrc","previewThumbnails","src","currentMediaSrc","inputSrcType","size","parseInt","push","tracks","processingCaption","kind","label","srclang","poster","JSON","stringify","copy2clip","ClipboardJS","message","tempID","Date","getTime","append","setTimeout","now","show","removeAttr","on","e","clearSelection","messageBox"],"mappings":"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","sourcesContent":["// jshint esversion: 9\r\n// -------------------------------------\r\n// Chung\r\n// -------------------------------------\r\n// #region\r\n// Tốc độ hiệu ứng\r\nconst KHPGen = {\r\n  aniSpeed: \"fast\",\r\n  minus_icon: `➖`,\r\n  aniReplaceHTML(selector, content, duration) {\r\n    $(selector).fadeOut(duration, () => $(selector).html(content).fadeIn(duration));\r\n  },\r\n  aniAppendTo(takeThis, appendHere, aniSpeed = KHPGen.aniSpeed) {\r\n    $(takeThis)\r\n      .css({\r\n        \"display\": \"none\"\r\n      })\r\n      .appendTo(appendHere)\r\n      .slideDown(aniSpeed);\r\n  },\r\n  ADD_EPISODE(elem) {\r\n    $(elem)\r\n      .parent(\".addRemoveEpBtn\")\r\n      .parent(\".episode_container\")\r\n      .after($(\"#phantomZoneCtn .episode_container\").clone().hide())\r\n      .next().slideDown(KHPGen.aniSpeed);\r\n  },\r\n  REMOVE_EPISODE(elem) {\r\n    let a = $(elem).parent(\".addRemoveEpBtn\").parent(\".episode_container\");\r\n    a.slideUp(KHPGen.aniSpeed, () => a.remove());\r\n  },\r\n  ADD_SOURCE(elem) {\r\n    KHPGen.aniAppendTo(\r\n      $(\"#temp_zone #singleSrcCtn\").clone(),\r\n      $(elem).parent(\"#singleSrcCtn\").parent(\"#ALL_SRCS_CTN\"),\r\n      KHPGen.aniSpeed);\r\n  },\r\n  REMOVE_SOURCE(elem) {\r\n    let a = $(elem).parent('#singleSrcCtn');\r\n    a.slideUp(KHPGen.aniSpeed, () => a.remove());\r\n  },\r\n  ADD_CAPTIONS(elem) {\r\n    let a = $(\"#temp_zone #singleCapCtn\").clone(),\r\n      b = $(elem).parent(\"#singleCapCtn\").parent(\"#ALL_CAPS_CTN\");\r\n    KHPGen.aniAppendTo(a, b, KHPGen.aniSpeed);\r\n  },\r\n  REMOVE_CAPTIONS(elem) {\r\n    let a = $(elem).parent('#singleCapCtn');\r\n    a.slideUp(KHPGen.aniSpeed, () => a.remove());\r\n  },\r\n  SELECT_TYPE(elem) {\r\n    let a = $(elem)\r\n      .parent(\".dropdown-menu\")\r\n      .parent(\"#typeSelectorContainer\")\r\n      .find(\"#typeSelectorBtn\"),\r\n      b = $(elem).html();\r\n    KHPGen.aniReplaceHTML(a, b, KHPGen.aniSpeed);\r\n    a.attr(\"selected-type\", $(elem).attr(\"type-data\"));\r\n  },\r\n  SELECT_RES(elem) {\r\n    let a =\r\n      $(elem)\r\n      .parent(\".dropdown-menu\")\r\n      .parent(\"#qualitySelectorContainer\")\r\n      .find(\"#qualitySelectorBtn\"),\r\n      b = $(elem).html();\r\n    KHPGen.aniReplaceHTML(a, b, KHPGen.aniSpeed);\r\n    a.attr(\"selected-res\", $(elem).attr(\"res-data\"));\r\n  },\r\n  saveAsJSON(string) {\r\n    let text = string,\r\n      filename = UNIQUE_ID,\r\n      blob = new Blob([text], {\r\n        type: \"application/json\"\r\n      });\r\n    saveAs(blob, filename);\r\n  },\r\n  downloadData() {\r\n    saveAsJSON(generateCodeFromUserInput());\r\n  },\r\n  completeResult(elem) {\r\n    $('#masterPosterContainer, .episode_container').slideUp(KHPGen.aniSpeed);\r\n    $('#addOrCreateNewCtn').slideDown(KHPGen.aniSpeed);\r\n    $(elem).html(\"Quay lại chỉnh sửa\");\r\n    $(elem).attr('onclick', \"KHPGen.editResult(this)\");\r\n  },\r\n  editResult(elem) {\r\n    $('#addOrCreateNewCtn, #createNewPPCtn, #existedPPCtn').slideUp(KHPGen.aniSpeed);\r\n    $('#masterPosterContainer, .episode_container').slideDown(KHPGen.aniSpeed);\r\n    $(elem).html(\"Hoàn thành\");\r\n    $(elem).attr('onclick', \"KHPGen.completeResult(this)\");\r\n  },\r\n  generateCodeFromUserInput() {\r\n    // Ẩn khung export\r\n    $(\"#outputPanel\").slideUp(KHPGen.aniSpeed);\r\n\r\n    // Array chứa data thô toàn bộ input từ người dùng\r\n    const RAW_DATA = [];\r\n\r\n    // Lấy url của poster tổng, để ngoài này thay vì trong vòng lặp dưới để tránh việc #masterPosterInput bị fetch nhiều lần, ảnh hưởng tới hiệu năng\r\n    let finalMasPoster = $(\"#masterPosterInput\").val() || \"\";\r\n    //   finalMasPoster;\r\n    // if (inputMasPoster) {\r\n    //   finalMasPoster = inputMasPoster;\r\n    // } else {\r\n    //   finalMasPoster = \"https://cdn.jsdelivr.net/gh/DELNEGEND/khplayer/dist/default_wating.svg\";\r\n    // }\r\n\r\n    // Xử lý từng episode\r\n    $(\"#userInteractCtn .episode_container\").each((index, value) => {\r\n      if ($(value).find(\".title\").val()) {\r\n        let\r\n          // Object tạm thời để đẩy dần dữ liệu vào, cuối cùng đẩy vào RAW_DATA\r\n          processingEpElem = {},\r\n          // checkSubsExist: True khi ô input tên sub được điền, False khi không có\r\n          checkSubsExist = $(value).find(\"#ALL_CAPS_CTN\").find(\"#singleCapCtn\").find(\".captionFullName\").val(),\r\n          // Lấy url của poster con của từng tập\r\n          inputEpPoster = $(value).find(\".essentials\").find(\".poster\").val();\r\n\r\n        processingEpElem.type = \"video\";\r\n        processingEpElem.title = $(value).find(\".title\").val();\r\n        processingEpElem.sources = [];\r\n\r\n        let preThumbSrc = $(value).find(\".previewThumbnail\").val();\r\n        if (preThumbSrc) processingEpElem.previewThumbnails = {\r\n          src: preThumbSrc\r\n        };\r\n        // Xử lý từng source\r\n        $(value).find(\"#ALL_SRCS_CTN\").find(\"#singleSrcCtn\").each((index, value) => {\r\n          let currentMediaSrc = {};\r\n\r\n          // URL\r\n          let inputSrcType = $(value).find(\"#typeSelectorContainer\").find(\"#typeSelectorBtn\").attr(\"selected-type\");\r\n          currentMediaSrc.src = $(value).find(\".mediaSrc\").val();\r\n\r\n          // Type\r\n          if (inputSrcType != 'undefined') {\r\n            currentMediaSrc.type = inputSrcType;\r\n          } else {\r\n            currentMediaSrc.type = \"video/mp4\";\r\n          }\r\n\r\n          // Quality\r\n          let a = $(value).find(\"#qualitySelectorContainer\").find(\"#qualitySelectorBtn\").attr(\"selected-res\");\r\n          if (a != null) {\r\n            currentMediaSrc.size = parseInt(a);\r\n          } else {\r\n            currentMediaSrc.size = 1080;\r\n          }\r\n\r\n          // Push lên processingEpElem.sources\r\n          processingEpElem.sources.push(currentMediaSrc);\r\n        });\r\n        // Xử lý từng phụ đề\r\n        if (checkSubsExist) {\r\n          processingEpElem.tracks = [];\r\n          $(value).find(\"#ALL_CAPS_CTN\").find(\"#singleCapCtn\").each((index, value) => {\r\n            let processingCaption = {};\r\n            processingCaption.kind = \"subtitles\";\r\n            processingCaption.label = $(value).find(\".captionFullName\").val();\r\n            processingCaption.srclang = $(value).find(\".captionShortName\").val();\r\n            processingCaption.src = $(value).find(\".capionSrc\").val();\r\n            processingEpElem.tracks.push(processingCaption);\r\n          });\r\n        }\r\n        // Phần poster\r\n        let finalEpPoster;\r\n        if (inputEpPoster) {\r\n          finalEpPoster = inputEpPoster;\r\n        } else {\r\n          finalEpPoster = finalMasPoster;\r\n        }\r\n        processingEpElem.poster = finalEpPoster;\r\n\r\n        // Đẩy lên array\r\n        RAW_DATA.push(processingEpElem);\r\n      }\r\n    });\r\n\r\n    // Đấy url poster tổng cũng như ID lên data\r\n    RAW_DATA.push(finalMasPoster);\r\n    RAW_DATA.push(UNIQUE_ID);\r\n    return JSON.stringify(RAW_DATA);\r\n  },\r\n  copy2clip: new ClipboardJS(\".copy2clip\"),\r\n  messageBox(message = \"Thông báo!\", duration = 1000) {\r\n    // Type: https://getbootstrap.com/docs/4.0/components/alerts/\r\n\r\n    // Tạo 1 id tạm thời cho container thông báo, mỗi 1 noti là 1 id riêng, tránh trùng lặp với noti trước nếu 2 cái overlap nhau\r\n    let tempID = `_${new Date().getTime()}`;\r\n    // Tạo container chứa messageBox nếu chưa có\r\n    if ($('.alertCtn')[0] === void 0) {\r\n      $(\"body\").append(`<div class=\"alertCtn\"><div class=\"innerAlertCtn\"></div></div>`);\r\n    }\r\n    $('.innerAlertCtn').append(`<div class=\"alert\" id=\"${tempID}\" role=\"alert\" style=\"display:none\">${message}</div>`);\r\n    $(`#${tempID}`).slideDown(\"normal\");\r\n    setTimeout(() => {\r\n      $(`#${tempID}`).slideUp(\"normal\", () => $(`#${tempID}`).remove());\r\n    }, duration);\r\n  },\r\n};\r\nvar UNIQUE_ID = \"KHP_\" + Date.now();\r\n\r\n$(\"#qualitySelectorContainer .dropdown-item\").attr(\"onclick\", \"KHPGen.SELECT_RES(this)\");\r\n$(\"#typeSelectorContainer .dropdown-item\").attr(\"onclick\", \"KHPGen.SELECT_TYPE(this)\");\r\n\r\n// Clone toàn bộ template vào mainframe\r\n$(\"#phantomZoneCtn .episode_container\")\r\n  .clone()\r\n  .appendTo(\"#userInteractCtn\")\r\n  .show();\r\n\r\n// Clone #singleSrcCtn từ template vào #temp_zone để xử lý\r\n$(\"#phantomZoneCtn #ALL_SRCS_CTN #singleSrcCtn\")\r\n  .clone()\r\n  .appendTo(\"#phantomZoneCtn #temp_zone\");\r\n\r\n// addSource -> removeSource trong #temp_zone\r\n$(\"#temp_zone #addSourceBtn\")\r\n  .attr(\"onclick\", \"KHPGen.REMOVE_SOURCE(this)\")\r\n  .removeAttr(\"id\")\r\n  .html(KHPGen.minus_icon);\r\n\r\n// Clone #singleCapCtn từ template vào #temp_zone để xử lý\r\n$(\"#phantomZoneCtn #ALL_CAPS_CTN #singleCapCtn\")\r\n  .clone()\r\n  .appendTo(\"#phantomZoneCtn #temp_zone\");\r\n\r\n// addCaps -> removeCaps trong #singleCapCtn trong #temp_zone\r\n$(\"#temp_zone #addCaptionBtn\")\r\n  .attr(\"onclick\", \"KHPGen.REMOVE_CAPTIONS(this)\")\r\n  .removeAttr(\"id\")\r\n  .html(KHPGen.minus_icon);\r\n\r\n// Clone nút add từ template vào #temp_zone để xử lý\r\n$(\"#phantomZoneCtn #addEpBtn\").clone().appendTo(\"#phantomZoneCtn .addRemoveEpBtn\");\r\n\r\n// addEp -> removeEp trong #temp_zone\r\n$(\"#phantomZoneCtn #addEpBtn:nth-child(2)\")\r\n  .removeAttr(\"id\")\r\n  .attr(\"onclick\", \"KHPGen.REMOVE_EPISODE(this)\")\r\n  .html(KHPGen.minus_icon);\r\n\r\n$(\".editResult\").hide();\r\n$(\"#downloadJSON\").on(\"click\", () => KHPGen.saveAsJSON(KHPGen.generateCodeFromUserInput()));\r\n\r\n$(\"#createNewPPActionBtn\").on(\"click\", () => {\r\n  $(\"#createNewPPCode>code\").html(`&#x3C;div id=&#x22;${UNIQUE_ID}&#x22;&#x3E;&#x3C;/div&#x3E;`);\r\n  $(\"#existedPPCtn\").slideUp(KHPGen.aniSpeed);\r\n  $(\"#createNewPPCtn\").slideDown(KHPGen.aniSpeed);\r\n});\r\n$(\"#existedPPActionBtn\").on(\"click\", () => {\r\n  $(\"#existedPPCtnCode>code\").html(KHPGen.generateCodeFromUserInput(false));\r\n  $(\"#createNewPPCtn\").slideUp(KHPGen.aniSpeed);\r\n  $(\"#existedPPCtn\").slideDown(KHPGen.aniSpeed);\r\n});\r\nKHPGen.copy2clip.on(\"success\", e => {\r\n  e.clearSelection();\r\n  KHPGen.messageBox(\"Đã copy vào clipboard!\");\r\n});"],"file":"vendor.min.js"}