const KHPlayer={initPlyr:function(selector){return new Promise(function(resolve){resolve(Plyr.setup(selector,{seekTime:5,quality:{default:1080},captions:{active:!0,language:"auto",update:!0},i18n:{restart:"Khởi động lại",rewind:"Tua trước {seektime}s",play:"Phát",pause:"Tạm dừng",fastForward:"Tua tới {seektime}s",seek:"Tua",seekLabel:"{currentTime} của {duration}",played:"Đã phát",buffered:"Đã tải trước",currentTime:"Thời gian bây giờ",duration:"Thời lượng",volume:"Âm lượng",mute:"Tắt tiếng",unmute:"Bật tiếng",enableCaptions:"Bật phụ đề",disableCaptions:"Tắt phụ đề",download:"Tải xuống",enterFullscreen:"Toàn màn hình",exitFullscreen:"Thoát toàn màn hình",frameTitle:"Trình phát cho {title}",captions:"Phụ đề",settings:"Cài đặt",pip:"PIP",menuBack:"Quay lại",speed:"Tốc độ",normal:"Bình thường",quality:"Chất lượng",loop:"Lặp",start:"Bắt đầu",end:"Kết thúc",all:"Tất cả",reset:"Khởi động lại",disabled:"Tắt",enabled:"Bật",advertisement:"Quảng cáo",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}}}))})},init:async function(url){let d=document,PLAYLIST_=await KHPlayer.getJSON(url),uniqueKey=await PLAYLIST_[PLAYLIST_.length-1],uKs="#"+uniqueKey;KHPlayer["KHPPlaylist"+uniqueKey]=PLAYLIST_,PLAYLIST=KHPlayer["KHPPlaylist"+uniqueKey];let poster=await PLAYLIST[PLAYLIST.length-2];if(d.querySelector("#"+uniqueKey).innerHTML=`\n        <video control playsinline></video>\n        <ul key="${uniqueKey}" class='KHPPlaylistContainer'></ul>`,d.querySelector(uKs+" video").setAttribute("poster",poster),PLAYLIST.length>0){let index=0;for(;index<=PLAYLIST.length-3;){let currentID=+index,currentVid=PLAYLIST[index],list_ep=d.createElement("li");list_ep.setAttribute("index",currentID),d.querySelector(`#${uniqueKey} .KHPPlaylistContainer`).appendChild(list_ep);let currentLine=d.getElementById(uniqueKey).querySelector("li[index='"+currentID+"'");currentLine.innerHTML=currentVid.title,currentLine.setAttribute("onclick","KHPlayer.changeEp(this)"),index++}}KHPlayer.plyr[uniqueKey]=await KHPlayer.initPlyr(uKs+" video"),KHPlayer.plyr[uniqueKey][0].on("play",function(){KHPlayer._insertBefore(uKs+" .plyr__video-wrapper video",KHPlayer.htmlToElement("<div>a</div>"))}),KHPlayer.tweaks(uniqueKey)},tweaks:function(uniqueKey){let d=document,uKs="#"+uniqueKey;KHPlayer.insertAfter(uKs+" .plyr__controls>.plyr__menu",`<button class="plyr__controls__item plyr__control customBtn" type="button" onclick="KHPlayer.togglePlaylist('${uniqueKey}')">\n      <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="list-ul" class="svg-inline--fa fa-list-ul fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M48 48a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm448 16H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"></path></svg></button>`,!0),KHPlayer.insertAfter(uKs+" .plyr__controls > button:nth-child(1)",'<button class="plyr__controls__item plyr__control customBtn" type="button" onclick="KHPlayer.navigateEp(this,\'next\')">\n      <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="step-forward" class="svg-inline--fa fa-step-forward fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"></path></svg></button>',!0),KHPlayer._insertBefore(uKs+" .plyr__controls > button:nth-child(1)",'<button class="plyr__controls__item plyr__control customBtn" type="button" onclick="KHPlayer.navigateEp(this,\'prev\')">\n      <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="step-backward" class="svg-inline--fa fa-step-backward fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M64 468V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12v176.4l195.5-181C352.1 22.3 384 36.6 384 64v384c0 27.4-31.9 41.7-52.5 24.6L136 292.7V468c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12z"></path></svg>\n      </button>',!0),KHPlayer._insertBefore(uKs+" .plyr__video-wrapper video",d.querySelector(`.KHPPlaylistContainer[key='${uniqueKey}']`).cloneNode(!0)),d.querySelector(uKs+" .plyr__video-wrapper .KHPPlaylistContainer").setAttribute("class","EmbedKHPPlaylist hideEmbedKHPPlaylist"),KHPlayer.plyr[uniqueKey][0].on("enterfullscreen",event=>{localStorage.setItem("FullScreen"+uniqueKey,"enterFull")}),KHPlayer.plyr[uniqueKey][0].on("exitfullscreen",event=>{localStorage.setItem("FullScreen"+uniqueKey,"exitFull")})},changeEp:async function(elem){let index=parseInt(elem.getAttribute("index"),10),uniqueKey=await elem.parentNode.getAttribute("key"),uKs="#"+uniqueKey;KHPlayer.plyr[uniqueKey][0].destroy(),KHPlayer.plyr[uniqueKey][0]=await KHPlayer.initPlyr(uKs+" video"),select_all=document.querySelector(uKs+" .KHPPlaylistContainer").querySelectorAll("li");let currLi=document.querySelector(`${uKs} .KHPPlaylistContainer li[index='${index}']`);select_all.forEach(function(e){e.removeAttribute("playing"),e.removeAttribute("style")}),currLi.style.color="yellow",currLi.setAttribute("playing","true");let currData=KHPlayer["KHPPlaylist"+uniqueKey][index],currVideoTag=document.querySelector(uKs+" video");"M3U8"===currData.sources[0].type?(KHPlayer.m3u8(currVideoTag,currData.sources[0].src),null!=currData.tracks&&KHPlayer.addSubsForLibsPlayer(uKs+" video",currData.tracks[0])):(KHPlayer.plyr[uniqueKey][0].source=currData,KHPlayer.plyr[uniqueKey][0].play()),KHPlayer.plyr[uniqueKey][0].on("ended",function(){let next_episode=document.querySelectorAll("#"+uniqueKey+" li[playing='true']")[1].nextElementSibling;null!=next_episode&&next_episode.click()}),"enterFull"===localStorage.getItem("FullScreen"+uniqueKey)&&(console.log("changeOnFull"),setTimeout(()=>{KHPlayer.plyr[uniqueKey][0].fullscreen.enter()},5)),KHPlayer.tweaks(uniqueKey)},insertAfter:function(place,data,convertDataToElem=!1){let elem=document.querySelector(place);!1===convertDataToElem?elem.parentNode.insertBefore(data,elem.nextSibling):!0===convertDataToElem&&elem.parentNode.insertBefore(KHPlayer.htmlToElement(data),elem.nextSibling)},_insertBefore:function(place,data,convertDataToElem=!1){let elem=document.querySelector(place);!1===convertDataToElem?elem.parentNode.insertBefore(data,elem):!0===convertDataToElem&&elem.parentNode.insertBefore(KHPlayer.htmlToElement(data),elem)},togglePlaylist:function(uniqueKey){document.querySelector("#"+uniqueKey+" .EmbedKHPPlaylist").classList.toggle("hideEmbedKHPPlaylist")},selectCurrEp:function(uniqueKey){return document.querySelector(`#${uniqueKey} .KHPPlaylistContainer li[playing='true']`)},navigateEp:function(elem,nextOrPrev){let uniqueKey=elem.parentNode.parentNode.parentNode.getAttribute("id"),currEp=KHPlayer.selectCurrEp(uniqueKey);if(null===currEp&&document.querySelector("#"+uniqueKey+" .KHPPlaylistContainer li[index='0']").click(),null!==currEp){let nextEp=currEp.nextElementSibling,prevEp=currEp.previousElementSibling;"next"===nextOrPrev&&null!==nextEp&&nextEp.click(),"prev"===nextOrPrev&&(null===prevEp?currEp.click():prevEp.click())}},m3u8:function(elem,source){if(Hls.isSupported()){var hls=new Hls;hls.loadSource(source),hls.attachMedia(elem),hls.on(Hls.Events.MANIFEST_PARSED,function(){elem.play()})}},getJSON:function(url){return new Promise(function(resolve,reject){var request=new XMLHttpRequest;request.open("GET",url,!0),request.onreadystatechange=function(){if(4===this.readyState)if(this.status>=200&&this.status<400){var data=JSON.parse(this.responseText);resolve(data)}else reject(new Error("Double check JSON path/url"))},request.send(),request=null})},addSubsForLibsPlayer:function(elem,data){let tempSub=`<track kind="subtitles" label="${data.label}" srclang="${data.srclang}" src="${data.src}">`;document.querySelector(elem).appendChild(KHPlayer.htmlToElement(tempSub))},htmlToElement:function(html){var template=document.createElement("template");return html=html.trim(),template.innerHTML=html,template.content.firstChild},jsonPaths:JSON.parse(document.currentScript.getAttribute("jsonPath")),data:{},plyr:{}};KHPlayer.jsonPaths.forEach(function(e){KHPlayer.init(e)});
//# sourceMappingURL=khplayer.min.js.map
